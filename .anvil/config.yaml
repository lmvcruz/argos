# Anvil Configuration for Argos Project
# This configuration enables Anvil validation framework for the Argos project

version: 1.0

project:
  name: argos
  root: .
  language: python
  description: "Build automation and validation tooling suite"

validators:
  pytest:
    enabled: true
    description: "Python test execution with pytest"

    discovery:
      # Test file patterns for all Argos sub-projects
      patterns:
        - "forge/tests/test_*.py"
        - "anvil/tests/test_*.py"
        - "scout/tests/test_*.py"
        - "lens/tests/test_*.py"

      # Exclude patterns
      exclude:
        - "**/test_doc_examples.py"  # Documentation examples
        - "**/__pycache__/**"
        - "**/.*/**"

    options:
      # pytest execution options
      verbose: true
      capture: "no"  # Don't capture stdout/stderr
      timeout: 300  # 5 minute timeout per test
      maxfail: null  # Continue on failures (null = no limit)

      # Markers
      markers:
        - "slow: marks tests as slow (deselect with '-m \"not slow\"')"
        - "integration: marks tests as integration tests"
        - "unit: marks tests as unit tests"
        - "linux: marks tests that only run on Linux"
        - "windows: marks tests that only run on Windows"
        - "macos: marks tests that only run on macOS"

      # Additional pytest arguments
      addopts:
        - "--strict-markers"  # Fail on unknown markers
        - "--tb=short"  # Shorter traceback format

    coverage:
      enabled: false  # Will be enabled in Phase 2
      threshold: 90.0
      fail_under: 90.0
      report_formats:
        - "term-missing"
        - "html"

  flake8:
    enabled: false  # Will be enabled in Phase 3
    description: "Python code quality checks"

  black:
    enabled: false  # Will be enabled in Phase 3
    description: "Python code formatting checks"

# Execution history tracking
history:
  enabled: true
  database: ".anvil/history.db"
  retention_days: 90  # Keep history for 90 days

# Reporting
reporting:
  formats:
    - "console"
    - "json"
  output_dir: ".anvil/reports"

  console:
    show_summary: true
    show_failures: true
    show_slow_tests: true
    slow_threshold: 5.0  # seconds

# Performance
performance:
  parallel:
    enabled: false  # Will be enabled later
    workers: "auto"  # Number of parallel workers

  cache:
    enabled: true
    directory: ".anvil/cache"

# Metadata
metadata:
  created_by: "Anvil Setup - Phase 1.1"
  created_at: "2026-02-02"
  purpose: "Enable selective test execution with execution history tracking"
